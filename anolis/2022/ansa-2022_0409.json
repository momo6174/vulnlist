{
  "document": {
    "aggregate_severity": {
      "namespace": "https://openanolis.cn/sig/SIG-Infra/doc/1014149186600348472",
      "text": "Moderate"
    },
    "category": "csaf_vex",
    "csaf_version": "2.0",
    "distribution": {
      "text": "Copyright Â© OpenAnolis.cn All rights reserved",
      "tlp": {
        "label": "WHITE",
        "url": "https://www.first.org/tlp/"
      }
    },
    "lang": "en",
    "notes": [
      {
        "category": "summary",
        "text": "OpenAnolis ANSA-2022:0409",
        "title": "Title"
      },
      {
        "category": "description",
        "text": "Moderate: flatpak security and bug fix update",
        "title": "Description of the Errata"
      },
      {
        "category": "legal_disclaimer",
        "text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to OpenAnolis. and provide a link to the original.",
        "title": "Terms of Use"
      }
    ],
    "publisher": {
      "category": "vendor",
      "contact_details": "https://openanolis.cn/page/contact",
      "issuing_authority": "OpenAnolis Product Security is responsible for vulnerability handling across all OpenAnolis offerings.",
      "name": "Anolis OS Product Security Team",
      "namespace": "https://openanolis.cn/"
    },
    "references": [
      {
        "RefID": "",
        "RefURL": "",
        "Source": ""
      },
      {
        "RefID": "",
        "RefURL": "",
        "Source": ""
      },
      {
        "RefID": "",
        "RefURL": "",
        "Source": ""
      },
      {
        "RefID": "",
        "RefURL": "",
        "Source": ""
      }
    ],
    "title": "OpenAnolis Errata ANSA-2022:0409",
    "tracking": {
      "current_release_date": "2022-06-23 10:12:04",
      "id": "ANSA-2022:0409",
      "initial_release_date": "2022-06-23 10:12:04",
      "revision_history": [
        {
          "date": "2022-06-23 10:12:04",
          "number": "1",
          "summary": "Current version"
        }
      ]
    }
  },
  "product_tree": {
    "branches": [
      {
        "branches": [
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Anolis OS 8",
                "product": {
                  "name": "Anolis OS 8",
                  "product_id": "Anolis OS 8",
                  "product_identification_helper": {
                    "cpe": "cpe:2.3:o:openanolis:anolis_os:8:*:*:*:*:*:*:*"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "OpenAnolis Linux"
          },
          {
            "branches": [
              {
                "category": "product_version",
                "name": "flatpak-1.8.7-1.an8.aarch64",
                "product": {
                  "name": "flatpak-1.8.7-1.an8.aarch64",
                  "product_id": "flatpak-1.8.7-1.an8.aarch64",
                  "product_identification_helper": {
                    "cpe": "cpe:2.3:o:openanolis:anolis_os:8:*:*:*:*:*:*:*"
                  }
                }
              },
              {
                "category": "product_version",
                "name": "flatpak-libs-1.8.7-1.an8.aarch64",
                "product": {
                  "name": "flatpak-libs-1.8.7-1.an8.aarch64",
                  "product_id": "flatpak-libs-1.8.7-1.an8.aarch64",
                  "product_identification_helper": {
                    "cpe": "cpe:2.3:o:openanolis:anolis_os:8:*:*:*:*:*:*:*"
                  }
                }
              },
              {
                "category": "product_version",
                "name": "flatpak-session-helper-1.8.7-1.an8.aarch64",
                "product": {
                  "name": "flatpak-session-helper-1.8.7-1.an8.aarch64",
                  "product_id": "flatpak-session-helper-1.8.7-1.an8.aarch64",
                  "product_identification_helper": {
                    "cpe": "cpe:2.3:o:openanolis:anolis_os:8:*:*:*:*:*:*:*"
                  }
                }
              }
            ],
            "category": "architecture",
            "name": "aarch64"
          },
          {
            "branches": [
              {
                "category": "product_version",
                "name": "flatpak-selinux-1.8.7-1.an8.noarch",
                "product": {
                  "name": "flatpak-selinux-1.8.7-1.an8.noarch",
                  "product_id": "flatpak-selinux-1.8.7-1.an8.noarch",
                  "product_identification_helper": {
                    "cpe": "cpe:2.3:o:openanolis:anolis_os:8:*:*:*:*:*:*:*"
                  }
                }
              }
            ],
            "category": "architecture",
            "name": "noarch"
          },
          {
            "branches": [
              {
                "category": "product_version",
                "name": "flatpak-1.8.7-1.an8.src",
                "product": {
                  "name": "flatpak-1.8.7-1.an8.src",
                  "product_id": "flatpak-1.8.7-1.an8.src",
                  "product_identification_helper": {
                    "cpe": "cpe:2.3:o:openanolis:anolis_os:8:*:*:*:*:*:*:*"
                  }
                }
              }
            ],
            "category": "architecture",
            "name": "src"
          },
          {
            "branches": [
              {
                "category": "product_version",
                "name": "flatpak-1.8.7-1.an8.x86_64",
                "product": {
                  "name": "flatpak-1.8.7-1.an8.x86_64",
                  "product_id": "flatpak-1.8.7-1.an8.x86_64",
                  "product_identification_helper": {
                    "cpe": "cpe:2.3:o:openanolis:anolis_os:8:*:*:*:*:*:*:*"
                  }
                }
              },
              {
                "category": "product_version",
                "name": "flatpak-libs-1.8.7-1.an8.x86_64",
                "product": {
                  "name": "flatpak-libs-1.8.7-1.an8.x86_64",
                  "product_id": "flatpak-libs-1.8.7-1.an8.x86_64",
                  "product_identification_helper": {
                    "cpe": "cpe:2.3:o:openanolis:anolis_os:8:*:*:*:*:*:*:*"
                  }
                }
              },
              {
                "category": "product_version",
                "name": "flatpak-session-helper-1.8.7-1.an8.x86_64",
                "product": {
                  "name": "flatpak-session-helper-1.8.7-1.an8.x86_64",
                  "product_id": "flatpak-session-helper-1.8.7-1.an8.x86_64",
                  "product_identification_helper": {
                    "cpe": "cpe:2.3:o:openanolis:anolis_os:8:*:*:*:*:*:*:*"
                  }
                }
              }
            ],
            "category": "architecture",
            "name": "x86_64"
          }
        ],
        "category": "vendor",
        "name": "OpenAnolis"
      }
    ],
    "relationships": [
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "flatpak-1.8.7-1.an8.aarch64 as component of Anolis OS 8",
          "product_id": "Anolis OS 8:flatpak-1.8.7-1.an8.aarch64"
        },
        "product_reference": "flatpak-1.8.7-1.an8.aarch64",
        "relates_to_product_reference": "Anolis OS 8"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "flatpak-libs-1.8.7-1.an8.aarch64 as component of Anolis OS 8",
          "product_id": "Anolis OS 8:flatpak-libs-1.8.7-1.an8.aarch64"
        },
        "product_reference": "flatpak-libs-1.8.7-1.an8.aarch64",
        "relates_to_product_reference": "Anolis OS 8"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "flatpak-session-helper-1.8.7-1.an8.aarch64 as component of Anolis OS 8",
          "product_id": "Anolis OS 8:flatpak-session-helper-1.8.7-1.an8.aarch64"
        },
        "product_reference": "flatpak-session-helper-1.8.7-1.an8.aarch64",
        "relates_to_product_reference": "Anolis OS 8"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "flatpak-1.8.7-1.an8.src as component of Anolis OS 8",
          "product_id": "Anolis OS 8:flatpak-1.8.7-1.an8.src"
        },
        "product_reference": "flatpak-1.8.7-1.an8.src",
        "relates_to_product_reference": "Anolis OS 8"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "flatpak-1.8.7-1.an8.x86_64 as component of Anolis OS 8",
          "product_id": "Anolis OS 8:flatpak-1.8.7-1.an8.x86_64"
        },
        "product_reference": "flatpak-1.8.7-1.an8.x86_64",
        "relates_to_product_reference": "Anolis OS 8"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "flatpak-libs-1.8.7-1.an8.x86_64 as component of Anolis OS 8",
          "product_id": "Anolis OS 8:flatpak-libs-1.8.7-1.an8.x86_64"
        },
        "product_reference": "flatpak-libs-1.8.7-1.an8.x86_64",
        "relates_to_product_reference": "Anolis OS 8"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "flatpak-session-helper-1.8.7-1.an8.x86_64 as component of Anolis OS 8",
          "product_id": "Anolis OS 8:flatpak-session-helper-1.8.7-1.an8.x86_64"
        },
        "product_reference": "flatpak-session-helper-1.8.7-1.an8.x86_64",
        "relates_to_product_reference": "Anolis OS 8"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "flatpak-selinux-1.8.7-1.an8.noarch as component of Anolis OS 8",
          "product_id": "Anolis OS 8:flatpak-selinux-1.8.7-1.an8.noarch"
        },
        "product_reference": "flatpak-selinux-1.8.7-1.an8.noarch",
        "relates_to_product_reference": "Anolis OS 8"
      }
    ]
  },
  "vulnerabilities": [
    {
      "cve": "CVE-2021-43860",
      "ids": [
        {
          "system_name": "OpenAnolis CVE Page",
          "text": "https://anas.openanolis.cn/cves/detail/CVE-2021-43860"
        }
      ],
      "notes": [
        {
          "category": "description",
          "text": "Flatpak is a Linux application sandboxing and distribution framework. Prior to versions 1.12.3 and 1.10.6, Flatpak doesn't properly validate that the permissions displayed to the user for an app at install time match the actual permissions granted to the app at runtime, in the case that there's a null byte in the metadata file of an app. Therefore apps can grant themselves permissions without the consent of the user. Flatpak shows permissions to the user during install by reading them from the \"xa.metadata\" key in the commit metadata. This cannot contain a null terminator, because it is an untrusted GVariant. Flatpak compares these permissions to the *actual* metadata, from the \"metadata\" file to ensure it wasn't lied to. However, the actual metadata contents are loaded in several places where they are read as simple C-style strings. That means that, if the metadata file includes a null terminator, only the content of the file from *before* the terminator gets compared to xa.metadata. Thus, any permissions that appear in the metadata file after a null terminator are applied at runtime but not shown to the user. So maliciously crafted apps can give themselves hidden permissions. Users who have Flatpaks installed from untrusted sources are at risk in case the Flatpak has a maliciously crafted metadata file, either initially or in an update. This issue is patched in versions 1.12.3 and 1.10.6. As a workaround, users can manually check the permissions of installed apps by checking the metadata file or the xa.metadata key on the commit metadata.",
          "title": "Vulnerability description"
        },
        {
          "category": "general",
          "text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
          "title": "CVSS score applicability"
        }
      ],
      "product_status": {
        "fixed": [
          "Anolis OS 8:flatpak-1.8.7-1.an8.aarch64",
          "Anolis OS 8:flatpak-1.8.7-1.an8.src",
          "Anolis OS 8:flatpak-1.8.7-1.an8.x86_64",
          "Anolis OS 8:flatpak-libs-1.8.7-1.an8.aarch64",
          "Anolis OS 8:flatpak-libs-1.8.7-1.an8.x86_64",
          "Anolis OS 8:flatpak-selinux-1.8.7-1.an8.noarch",
          "Anolis OS 8:flatpak-session-helper-1.8.7-1.an8.aarch64",
          "Anolis OS 8:flatpak-session-helper-1.8.7-1.an8.x86_64"
        ]
      },
      "references": [
        {
          "RefID": "",
          "RefURL": "",
          "Source": ""
        },
        {
          "RefID": "",
          "RefURL": "",
          "Source": ""
        },
        {
          "RefID": "",
          "RefURL": "",
          "Source": ""
        }
      ],
      "remediations": [
        {
          "category": "vendor_fix",
          "details": "To fix this cve, please use the installation method recommended by Anolis: find the corresponding system's errata on the cve page, and then use errata to fix it. For details, please refer to references. For example, to fix a cve on Anolis OS 23: yum update --advisory ANSA-2024: xxxx",
          "product_ids": [
            "Anolis OS 8:flatpak-1.8.7-1.an8.aarch64",
            "Anolis OS 8:flatpak-1.8.7-1.an8.src",
            "Anolis OS 8:flatpak-1.8.7-1.an8.x86_64",
            "Anolis OS 8:flatpak-libs-1.8.7-1.an8.aarch64",
            "Anolis OS 8:flatpak-libs-1.8.7-1.an8.x86_64",
            "Anolis OS 8:flatpak-selinux-1.8.7-1.an8.noarch",
            "Anolis OS 8:flatpak-session-helper-1.8.7-1.an8.aarch64",
            "Anolis OS 8:flatpak-session-helper-1.8.7-1.an8.x86_64"
          ]
        }
      ],
      "scores": [
        {
          "cvss_v3": {
            "attackComplexity": "LOW",
            "attackVector": "LOCAL",
            "availabilityImpact": "NONE",
            "baseScore": 8.2,
            "baseSeverity": "HIGH",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "privilegesRequired": "NONE",
            "scope": "CHANGED",
            "userInteraction": "REQUIRED",
            "vectorString": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N",
            "version": "3.1",
            "products": null
          }
        }
      ],
      "threats": [
        {
          "category": "impact",
          "date": "2022-06-15 10:53:13",
          "details": "Important"
        }
      ],
      "title": "CVE-2021-43860"
    }
  ]
}